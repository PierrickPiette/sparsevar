%VignetteIndexEntry{sparsevar}
%VignetteEngine{R.rsp::tex}

\documentclass[article, nojss]{jss}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% declarations for jss.cls %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsmath, amsthm, amsfonts, verbatim}
\usepackage{multirow, hhline}

%% almost as usual
\author{Monica Billio\\Universit\`a di Venezia \And 
        Lorenzo Frattarolo\\Universit\`a di Venezia \And 
        Simone Vazzoler\\Universit\`a di Venezia}
\title{The \pkg{sparsevar} package}

%% for pretty printing and a nice hypersummary also set:
\Plainauthor{Monica Billio, Lorenzo Frattarolo, Simone Vazzoler} %% comma-separated
\Plaintitle{sparsevar package} %% without formatting
\Shorttitle{\pkg{sparsevar}: VAR/VECM estimation under sparsity hypothesis} %% a short title (if necessary)

%% an abstract and keywords
\Abstract{
  The \pkg{sparsevar} package it is useful to estimate VAR/VECM models under the sparsity assumption.
}
\Keywords{VAR, VECM, sparse, high-dimensional}
\Plainkeywords{var, vecm, sparse, high-dimensional} %% without formatting
%% at least one keyword must be supplied

%% publication information
%% NOTE: Typically, this can be left commented and will be filled out by the technical editor
%% \Volume{50}
%% \Issue{9}
%% \Month{June}
%% \Year{2012}
%% \Submitdate{2012-06-04}
%% \Acceptdate{2012-06-04}

%% The address of (at least) one author should be given
%% in the following format:
\Address{
  Monica Billio\\
  Department of Economics\\
  Universit\`a Ca' Foscari di Venezia\\
  San Giobbe 873, Venezia\\
  E-mail: \email{billio@unive.it}\\
  URL: \url{http://venus.unive.it/billio/}\\
  \\
  Lorenzo Frattarolo\\
  Department of Economics\\
  Universit\`a Ca' Foscari di Venezia\\
  San Giobbe 873, Venezia\\
  E-mail: \email{lorenzo.frattarolo@unive.it}\\
  \\
  Simone Vazzoler\\
  Department of Economics\\
  Universit\`a Ca' Foscari di Venezia\\
  San Giobbe 873, Venezia\\
  E-mail: \email{svazzole@gmail.com}\\
}

%% It is also possible to add a telephone and fax number
%% before the e-mail in the following format:
%% Telephone: +43/512/507-7103
%% Fax: +43/512/507-2851

%% for those who use Sweave please include the following line (with % symbols):
%% need no \usepackage{Sweave.sty}

%% end of declarations %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newtheorem{teorema}{Theorem}
\newtheorem{teo}{Theorem}[section]
\newtheorem{theorem}[teo]{Theorem}
\newtheorem{defin}[teo]{Definition}
\newtheorem{definition}[teo]{Definition}
\newtheorem{prop}[teo]{Proposition}
\newtheorem{proposition}[teo]{Proposition}
\newtheorem{lemma}[teo]{Lemma}
\newtheorem{cor}[teo]{Corollary}
\theoremstyle{definition}
\newtheorem{ese}[teo]{Example}
\newtheorem{oss}[teo]{Remark}
\newtheorem{remark}[teo]{Remark}
\numberwithin{equation}{section}
\newtheorem{assumption}[teo]{Assumption}


\begin{document}

%% include your article here, just as usual
%% Note that you should use the \pkg{}, \proglang{} and \code{} commands.

\section[Introduction]{Introduction}

\pkg{sparsevar} is an \proglang{R} \citep{rlang} package that estimates sparse VAR and VECM model using penalized least squares methods (PLS): it is possible to use ENET \citep{glmnet}, SCAD \citep{ncvreg} or MC+ penalties. The sparsity parameter can be estimated using cross-validation, repeated cross-validation or time slicing \citep{hynd2013}. When using ENET it is possible to estimate VAR(1) of dimension up to 200, while when using one of the other two is better not to go beyond 50. When estimating a VAR($p$) model then the limits are roughly $200/p$ and $50/p$, respectively.

The authors of \pkg{sparsevar} are Monica Billio, Lorenzo Frattarolo and Simone Vazzoler and the \proglang{R} package is mantained by Simone Vazzoler. This article describes the usage of \pkg{sparsevar} in \proglang{R}.
\citep{lutkepohl2007new}, \citep{basu2015}.


\section[VAR/VECM models]{VAR/VECM models}

\begin{defin}
A VAR$(p)$ process is a model of the following type:
\begin{equation}
  \label{eq:varp}
  y_t = \nu + A_1 y_{t-1} + A_2 y_{t-2} + \ldots + A_p y_{t-p} + \varepsilon_t
\end{equation}
for $t = 0, \pm 1, \pm 2, \ldots$, where $y_t = (y_{1t},\ldots,y_{Kt})^T\in\mathbb{R}^K$ is a $K\times 1$ random vector, the $A_i$ are fixed (i.e. not varying with time) $K\times K$ real matrices, $\nu = (\nu_1,\ldots,\nu_K)^T$ is a fixed vector for the mean $\mathbb E (y_t)$ and $\varepsilon_t = (\varepsilon_{1t}, \ldots, \varepsilon_{Kt})^T$ is a $K$-dimensional white noise (or innovation process) with $\mathbb E(\varepsilon_t)=0$, $\mathbb{E}(\varepsilon_t\varepsilon_t^T) = \Sigma_\varepsilon$ and $\mathbb{E}(\varepsilon_t\varepsilon_s^T) = 0$ for $s\neq t$.
\end{defin}
We recall that a VAR$(1)$ process is called \textbf{stable} if $\rho(A_1) < 1$ where
  \begin{equation}
    \label{eq:spectralRadiusDefin}
    \rho(A) = \max\{|\lambda_1|,\ldots,|\lambda_K|\}
  \end{equation}
with $\lambda_j\in\mbox{spec}(A)$. In other words a VAR$(1)$ process is called stable if the matrix $A_1$ has all the eigenvalues inside the unit circle.
It is a well known fact that this is equivalent to saying that a VAR$(1)$ process is stable if and only if $\det(\mathbb{I}_K - A_1z)\neq 0$ for $|z|\leq 1$.
We can generalize this condition to a VAR$(p)$ process: if $y_t\sim\mbox{VAR}(p)$ as in Equation (\ref{eq:varp}) then we can rewrite it as 
\begin{equation}
  \label{eq:varpvar1}
  Y_t = \boldsymbol{\nu} + \boldsymbol{A}Y_{t-1} + U_t
\end{equation}
where 
\begin{gather*}
  Y_t = 
\begin{pmatrix}
  y_t\\y_{t-1}\\\vdots\\ y_{t-p+1}
\end{pmatrix}
\in\mathbb{R}^{Kp};
\quad\boldsymbol{\nu} = 
\begin{pmatrix}
  \nu\\0\\\vdots\\0
\end{pmatrix}
\in\mathbb{R}^{Kp}\\
\boldsymbol{A} = 
\begin{pmatrix}
A_1 & A_2 & \ldots & A_{p-1} & A_p\\
\mathbb{I}_K & \mathbb{O} & \ldots & \mathbb{O} & \mathbb{O}\\
\mathbb{O} & \mathbb{I}_K & \ldots & \mathbb{O} & \mathbb{O}\\
\vdots & \vdots & \ddots & \vdots & \vdots\\
\mathbb{O} & \mathbb{O} & \ldots & \mathbb{I}_K & \mathbb{O}
\end{pmatrix}\in\mbox{M}_{Kp\times Kp}(\mathbb{R});
\quad U_t = 
\begin{pmatrix}
u_t \\ 0 \\ \vdots \\ 0
\end{pmatrix}\in\mathbb{R}^{Kp}
\end{gather*}
So $Y_t$ is a VAR$(1)$ process that is stable if the usual condition on VAR$(1)$ processes holds true: 
\begin{equation*}
\det\left(\mathbb{I}_{Kp} - \boldsymbol{A}z\right)\neq 0
\quad\mbox{for}\,\,\, |z|\leq 1 
\end{equation*}
\begin{prop}
\begin{equation}
\det\left(\mathbb{I}_{Kp} - \boldsymbol{A}z\right)\neq 0
\quad\mbox{for}\,\,\, |z|\leq 1 
\end{equation}
if and only if
\begin{equation}
\det\left(\mathbb{I}_{K} - A_1z -A_2z^2-\ldots-A_pz^p\right)\neq 0
\quad\mbox{for}\,\,\, |z|\leq 1 
\end{equation}
\end{prop}
\begin{proof}

[...]

\end{proof}

\subsection{Granger Causality}
Granger Causality (GC) is based on the hypothesis that if a variable $x$
influences a variable $z$, then it should be useful in predicting $z$.
\begin{defin}
  Let $z_t(h|\Omega_t)$ be the minimum MSE $h$-step predictor for the
  process $z_t$ at origin $t$, based on the information contained in
  $\Omega_t$. Denote with $\Sigma_z(h|\Omega_t)$ the forecast. The
  process $x_t$ is said to GC $z_t$ if
  \begin{equation}
    \label{eq:gcdef}
    \Sigma_z(h|\Omega_t) < \Sigma_z(h|\Omega_t\setminus\{x_s|s\leq
    t\})\quad\mbox{for at least one } h=1,2,\ldots
  \end{equation}
\end{defin}
In other words, if $z_t$ can be predicted more efficiently if the
information in the $x_t$ process is taken into account in
addition to all other information in the universe, then $x_t$ is
Granger Causal (GC) for $z_t$ and we will write $x_t
\overset{GC}{\Longrightarrow} z_t$. We now extend the previous
definition to the multi-dimensional case.
\begin{defin}
  Let $z_t$ and $x_t$ be $M$ and $N$ dimensional processes respectively. $x_t$ is said to GC $z_t$ if
  \begin{equation}
    \Sigma_z(h|\Omega_t) \neq \Sigma_z(h|\Omega_t\setminus\{x_s|s\leq
    t\})
  \end{equation}
  and
  \begin{equation}
    \Sigma_z(h|\Omega_t) \leq \Sigma_z(h|\Omega_t\setminus\{x_s|s\leq
    t\})
  \end{equation}
  that is, the difference must be positive semidefinite.
\end{defin}
\begin{defin}
  We say that there is Instantaneous Granger Causality (IGC) between
  $z_t$ and $x_t$ if
  \begin{equation}
    \label{eq:igcdefin}
    \Sigma_z(1|\Omega_t\cup\{x_{t+1}\}) \leq \Sigma_z(1|\Omega_t)
  \end{equation}
\end{defin}

\subsection{Cointegration}

For an univariate AR$(1)$ process given by $y_t = \alpha y_{t-1} +
u_t$ the stability condition is $1-\alpha z\neq 0$ for $|z|\leq 1$ or,
equivalently, $|\alpha| < 1$. For $\alpha = 1$ the process is said to
be integrated of order one (written as I$(1)$)
\begin{equation}
  \label{eq:intprocess}
  y_t = y_{t-1} + u_t = y_0 + \sum_{i=1}^t u_i
\end{equation}
It is clear from the previous formula that an integrated process is the sum of all past
innovations; easily one can compute $\mathbb{E}(y_t) = y_0$ and
$\mbox{Var}(y_t)=t\mbox{Var}(u_t)=t\sigma_u^2$. \\
A general AR$(p)$ model is of the form 
\begin{equation}
  \label{eq:arpmodel}
  \Phi(L) y_t = \varepsilon_t
\end{equation}
with $\Phi(L) = 1 - \sum_{i=1}^p \alpha_iL^i$ ($L$ is the lag
operator). If the polinomial $\Phi(z)$ has one root on the unit circle
$|z|=1$, then the behaviour of the time series $y_t$ is similar to a
random walk.
\begin{defin}
  An univariate process with $d$ unit roots is called integrated
  process of order $d$ and is written I$(d)$.
\end{defin}
If there is only one unit root, i.e. the process is I$(1)$, by taking
first differences
\begin{equation}
  \label{eq:diff}
  \Delta y_t = y_t - y_{t-1} = (1-L)y_t 
\end{equation}
it is possible to obtain a stationary process. In the same way, if the
process $y_t$ is I$(d)$ then considering $\Delta^d = (1-L)^dy_t$ we
get a stationary process.

\section{Estimation of the model}

In general the estimation of a VAR model is not an easy task (as can be seen for example in \citep{tsay2013multivariate}). This fact is more true in the
high dimensional setting, where $K>n$ (in our notation $K$ is the dimension of the time series and $n$ is the number of observations
available). Thus, to proceed further, we make an additional hypothesis on the matrix $A$ of the VAR$(1)$ process:
\begin{itemize}
  \item[(\textbf{H})] the matrix $A$ is sparse.
\end{itemize}

This assumption allows us to use and adapt to our problem, the penalized methods in OLS estimation. \\
Following \citep{basu2015}, based on the data $\{y^0,\ldots,y^T\}$, we construct the following regression problem
\begin{equation}
  \label{eq:regressionproblem}
  \begin{pmatrix}
    (y^T)^\prime\\
    \vdots\\
    (y^0)^\prime
  \end{pmatrix} = 
  \begin{pmatrix}
    (y^{T-1})^\prime & \dots & (y^{T-d})^\prime\\
    \vdots & \ddots & \vdots\\
    (y^{d-1})^\prime & \dots & (y^0)^\prime
  \end{pmatrix}
  \begin{pmatrix}
    A_1^\prime\\
    \vdots\\
    A_d^\prime
  \end{pmatrix} + 
  \begin{pmatrix}
    (\varepsilon^T)^\prime\\
    \vdots\\
    (\varepsilon^d)^\prime
  \end{pmatrix}
\end{equation}
which can be rewritten as
\begin{align}
  \label{eq:vecregressionproblem}
  \mbox{vec}(\mathcal{Y}) &= \mbox{vec}(\mathcal{XB^*}) + \mbox{vec}(E)\\
                          &= (\mathbb I \otimes \mathcal{X}) \mbox{vec}(\mathcal{B^*}) + \mbox{vec}(E)\\
  Y &= X \beta^* + \mbox{vec}(E)
\end{align}

\subsection{Threshold}

\begin{equation}
  \label{eq:threshold}
  \hat T = \frac{1}{\sqrt{pN\log(T)}}
\end{equation}


\section[Using sparsevar]{Using \pkg{sparsevar}}

The two main functions of the package are \code{estimateVAR} and \code{estimateVECM}, which, as the names suggest, allow the user to estimate VAR and a VECM models respectively. There are other function included in the package which are useful for creating a sparse VAR process, such as \code{simulateVAR} and \code{createSparseMatrix}. 

\subsection[Using estimateVAR]{Using \code{estimateVAR}}

The function is used to estimate a VAR model given the time series \code{data} and must be called in the following way
\begin{CodeChunk}
  \begin{CodeInput}
    estimateVAR(data, p = 1, penalty = "ENET", options = list(...))
  \end{CodeInput}
\end{CodeChunk}
The variable \code{data} must be a matrix containing \code{N} different time series in columns with \code{nobs} observations displaced on different rows; \code{p} is the order of the VAR model (by default it has value \code{p = 1}) and \code{penalty} is a string which can the take the values \code{"ENET"} (default), \code{"SCAD"} or \code{"MCP"}.\\
The parameter \code{options} is a list containing global ([...]) and specific options (related to the penalty used in the estimation).\\
Global options:
\begin{itemize}
\item \code{parallel}: logical; use parallel computing (default \code{TRUE});
\item \code{ncores}: integer; number of cores to use if \code{parallel = TRUE};
\item \code{threshold}: logical; default is \code{FALSE}. If \code{TRUE} [...] 
\item \code{scale}: logical; scale the input \code{data} normalizing every column (default \code{TRUE}); 
\item \code{nfolds}: integer; the number of folds used in the cross validation (default \code{nfolds = 10}).
\end{itemize}

Options for \code{"ENET"}:
\begin{itemize}
\item \code{alpha}: a value in $[0,1]$; default is \code{alpha = 1} which uses LASSO penalty, while setting \code{alpha = 0} uses Ridge regression; using a value in $(0,1)$ uses a weighted linear combination of the of the two;
\item \code{type.measure}: \code{"mse"} or \code{"mae"}; the error used in the cross validation: \code{"mse"} mean square error (default) or \code{"mae"} mean absolute error; 
\item \code{nlambda}: integer; the number of lambdas to use in the cross validation; 
\item \code{repeatedCV}: logical; if \code{TRUE} the function performs repeated cross validation for model selection;
\item \code{nRepeats}: integer; the number of repeats in the repeated cross validation (if \code{repeatedCV = TRUE});
\item \code{foldIDs}: logical; if \code{TRUE} (default) the folds in the cross validation will be fixed; their ids will be assigned automatically in increasing order;
\item \code{timeSlice}: logical; if \code{TRUE} [...]
\item \code{leaveOutLast}: integer; the number of elements to leave out of sample when using the time slice option;
\item \code{horizon}: integer; the number of elements to use to compute the out of sample MSE when using the time slice option; 
\item \code{fixedWindow}: logical;
\end{itemize}

Options for \code{"SCAD"} and \code{"MCP"}:
\begin{itemize}
\item \code{eps}: positive real number;
\end{itemize}

\subsection[Using estimateVECM]{Using \code{estimateVECM}}

Use to estimate a VECM model.

\begin{CodeChunk}
  \begin{CodeInput}
    estimateVECM(data, p = 2, penalty = "ENET", logScale = TRUE, options = list(...))
  \end{CodeInput}
\end{CodeChunk}

The options are the same as in \code{estimateVAR}, except for the global option:
\begin{itemize}
\item \code{logScale}: logical; take the logarithm of the input \code{data}.
\end{itemize}

\subsection[Using estimateVECM]{Using \code{simulateVAR}}

[...]

\begin{CodeChunk}
  \begin{CodeInput}
    simulateVAR(N = 100, p = 1, sparsity = 0.05, rho = 0.5, ...
                covariance = "toeplitz")
  \end{CodeInput}
\end{CodeChunk}

\section[Simulation examples]{Simulation examples}

\begin{CodeChunk}
  \begin{CodeInput}
    est <- estimateVAR(data, p = 1, penalty = "ENET")
  \end{CodeInput}
\end{CodeChunk}

In Tables \ref{tab:MCSim}, \ref{tab:MCSim2}, \ref{tab:MCSim3} and \ref{tab:MCSim4}  are reported the relative errors computed using the Froebenius norm of the simulations performed. More specifically we recall that $\|A\|_{F} = \sqrt{\mbox{tr}(A^T A)}$ and the relative error is defined as $\frac{\|\hat A - A\|_F}{\|A\|_F}$. We examined 4 cases: $N = 10$, $T=30$ with \code{sparsity = 0.05} and $N=30$, $T=120$ with \code{sparsity = 0.05} both with the option \code{scale = TRUE} and \code{scale = FALSE}. All the simulations are reproducible and the code used can be found in the folder \code{simulations/}.

\begin{table}[!htp]
\centering
\begin{tabular}{|l|c|c|c|c|c|c|c|c|c|}
\hline
\multirow{2}{*}{$\|\hat A - A \|_F / \|A\|_F$}          & \multicolumn{3}{|c|}{\textbf{Block 1}}     &  \multicolumn{3}{c}{\textbf{Block 2}}      & \multicolumn{3}{|c|}{\textbf{Toeplitz}}     \\ \cline{2-10}
            & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9}  \\ \hline
LASSO       & 0.34         & 0.41         & 0.62         & 0.33         & 0.37         & 0.47         & 0.33         & 0.36         & 0.49          \\
            & (0.17)       & (0.23)       & (0.61)       & (0.17)       & (0.20)       & (0.30)       & (0.17)       & (0.18)       & (0.35)        \\ \hline
LASSO +     & 0.34         & 0.40         & 0.62         & 0.32         & 0.36         & 0.47         & 0.32         & 0.35         & 0.48          \\
Threshold   & (0.18)       & (0.23)       & (0.61)       & (0.17)       & (0.20)       & (0.30)       & (0.17)       & (0.18)       & (0.35)        \\ \hline
SCAD        & 0.29         & 0.35         & 0.57         & 0.27         & 0.30         & 0.41         & 0.27         &              &               \\ 
            & (0.19)       & (0.25)       & (0.72)       & (0.18)       & (0.23)       & (0.36)       & (0.17)       &              &               \\ \hline
SCAD +      &              &              &              &              &              &              &              &              &               \\
Threshold   &              &              &              &              &              &              &              &              &               \\ \hline
Basu        & 0.75         & 0.75         & 0.76         & 0.77         & 0.8          & 0.87         & 0.77         & 0.8          & 0.88          \\ \hline\hline
\multirow{2}{*}{Accuracy}          & \multicolumn{3}{|c|}{\textbf{Block 1}}     &  \multicolumn{3}{c}{\textbf{Block 2}}      & \multicolumn{3}{|c|}{\textbf{Toeplitz}}     \\ \cline{2-10}
          & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9}  \\ \hline
LASSO     & 0.88         & 0.88         & 0.88         &              &              &              &              &              &               \\
          & (0.08)       & (0.10)       & (0.12)       &              &              &              &              &              &               \\ \hline
LASSO +   & 0.97         & 0.96         & 0.94         & 0.97         & 0.96         & 0.95         & 0.97         & 0.96         & 0.94          \\
Threshold & (0.03)       & (0.04)       & (0.07)       & (0.03)       & (0.04)       & (0.06)       & (0.02)       & (0.04)       & (0.08)        \\ \hline
SCAD      &              &              &              &              &              &              &              &              &               \\ 
          &              &              &              &              &              &              &              &              &               \\ \hline
SCAD +    &              &              &              &              &              &              &              &              &               \\
Threshold &              &              &              &              &              &              &              &              &               \\ \hline
\end{tabular}
\caption{Results of 1000 simulations with $N = 10$, $T=30$, \code{sparsity = 0.05} and \code{scale = FALSE}}\label{tab:MCSim}
\end{table}


\begin{table}[!htp]
\centering
\begin{tabular}{|l|c|c|c|c|c|c|c|c|c|}
\hline
\multirow{2}{*}{$\|\hat A - A \|_F / \|A\|_F$}          & \multicolumn{3}{|c|}{\textbf{Block 1}}     &  \multicolumn{3}{c}{\textbf{Block 2}}      & \multicolumn{3}{|c|}{\textbf{Toeplitz}}     \\ \cline{2-10}
          & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9}  \\ \hline
LASSO     & 0.71         & 0.72         & 0.76         & 0.71         & 0.72         & 0.77         & 0.71         & 0.71         & 0.78          \\
          & (0.09)       & (0.11)       & (0.25)       & (0.09)       & (0.10)       & (0.23)       & (0.09)       & (0.09)       & (0.27)        \\ \hline
LASSO +   & 0.71         & 0.72         & 0.76         & 0.70         & 0.72         & 0.78         & 0.70         & 0.71         & 0.78          \\
Threshold & (0.09)       & (0.11)       & (0.25)       & (0.09)       & (0.10)       & (0.22)       & (0.09)       & (0.10)       & (0.27)        \\ \hline
SCAD      & 0.64         &              &              &              &              &              &              &              &               \\ 
          & (0.12)       &              &              &              &              &              &              &              &               \\ \hline
SCAD +    & 0.64         & 0.65         & 0.70         &              &              &              &              &              &               \\
Threshold & (0.12)       & (0.14)       & (0.17)       &              &              &              &              &              &               \\ \hline
Basu      & 0.75         & 0.75         & 0.76         & 0.77         & 0.8          & 0.87         & 0.77         & 0.8          & 0.88          \\ \hline\hline
\multirow{2}{*}{Accuracy}          & \multicolumn{3}{|c|}{\textbf{Block 1}}     &  \multicolumn{3}{c}{\textbf{Block 2}}      & \multicolumn{3}{|c|}{\textbf{Toeplitz}}     \\ \cline{2-10}
          & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9}  \\ \hline
LASSO     & 0.87         & 0.87         & 0.87         & 0.87         & 0.86         & 0.86         & 0.86         & 0.86         & 0.84          \\
          & (0.08)       & (0.09)       & (0.10)       & (0.09)       & (0.11)       & (0.12)       & (0.09)       & (0.10)       & (0.14)        \\ \hline
LASSO +   & 0.96         & 0.96         & 0.95         & 0.96         & 0.96         & 0.94         & 0.96         & 0.96         & 0.93          \\
Threshold & (0.03)       & (0.03)       & (0.05)       & (0.03)       & (0.05)       & (0.07)       & (0.03)       & (0.04)       & (0.09)        \\ \hline
SCAD      & 0.89         &              &              &              &              &              &              &              &               \\ 
          & (0.05)       &              &              &              &              &              &              &              &               \\ \hline
SCAD +    & 0.97         & 0.97         & 0.97         &              &              &              &              &              &               \\
Threshold & (0.02)       & (0.02)       & (0.02)       &              &              &              &              &              &               \\ \hline
\end{tabular}
\caption{Results of 1000 simulations with $N = 10$, $T=30$, \code{sparsity = 0.05} and \code{scale = TRUE}}\label{tab:MCSim2}
\end{table}


\begin{table}[!htp]
\centering
\begin{tabular}{|l|c|c|c|c|c|c|c|c|c|}
\hline
          & \multicolumn{3}{|c|}{\textbf{Block 1}}     &  \multicolumn{3}{c}{\textbf{Block 2}}      & \multicolumn{3}{|c|}{\textbf{Toeplitz}}     \\ \cline{2-10}
          & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9}  \\ \hline
LASSO     &              &              &              &              &              &              &              &              &               \\
          &              &              &              &              &              &              &              &              &               \\ \hline
LASSO +   &              &              &              &              &              &              &              &              &               \\
Threshold &              &              &              &              &              &              &              &              &               \\ \hline
SCAD      &              &              &              &              &              &              &              &              &               \\ 
          &              &              &              &              &              &              &              &              &               \\ \hline
MC+       &              &              &              &              &              &              &              &              &               \\
          &              &              &              &              &              &              &              &              &               \\ \hline
Basu      & 0.68         & 0.73         & 0.80         & 0.83         & 0.90         & 0.98         & 0.68         & 0.72         & 0.85          \\ \hline
\end{tabular}
\caption{Results of 1000 simulations with $N = 30$, $T=120$ and \code{scale = FALSE}}\label{tab:MCSim3}
\end{table}

\begin{table}[!htp]
\centering
\begin{tabular}{|l|c|c|c|c|c|c|c|c|c|}
\hline
          & \multicolumn{3}{|c|}{\textbf{Block 1}}     &  \multicolumn{3}{c}{\textbf{Block 2}}      & \multicolumn{3}{|c|}{\textbf{Toeplitz}}     \\ \cline{2-10}
          & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9} & \textbf{0.5} & \textbf{0.7} & \textbf{0.9}  \\ \hline
LASSO     &              &              &              &              &              &              &              &              &               \\
          &              &              &              &              &              &              &              &              &               \\ \hline
LASSO +   &              &              &              &              &              &              &              &              &               \\
Threshold &              &              &              &              &              &              &              &              &               \\ \hline
SCAD      &              &              &              &              &              &              &              &              &               \\ 
          &              &              &              &              &              &              &              &              &               \\ \hline
MC+       &              &              &              &              &              &              &              &              &               \\
          &              &              &              &              &              &              &              &              &               \\ \hline
Basu      & 0.68         & 0.73         & 0.80         & 0.83         & 0.90         & 0.98         & 0.68         & 0.72         & 0.85          \\ \hline
\end{tabular}
\caption{Results of 1000 simulations with $N = 30$, $T=120$ and \code{scale = TRUE}}\label{tab:MCSim4}
\end{table}

%% Note: If there is markup in \(sub)section, then it has to be escape as above.
% \bibliographystyle{jss}
\bibliography{src/bibliography}

\end{document}

